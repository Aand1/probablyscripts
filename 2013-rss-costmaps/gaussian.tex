\subsection{Typical Behavior}

The previous section asserted that, whatever the model parameters, optimal paths conform to a bracket shape. One might suppose that increasing the width of the obstacle $\sigma$ or the relative cost $A/P$ causes $\yhat$ to increase gradually, giving the obstacle a wider and wider berth. This dependence is observed for large $\yhat$, but when parameters are tuned to draw the optimal path closer to the origin, it undergoes a discontinuous jump from a finite bracket to the direct path ($\yhat=0$). As an example, consider the path in Figure \ref{fig:gaussian}. When $A/P=98/55$, a long walk around is cheap compared to treading on the origin, and the closest approach $\yhat=0.16\sigma$. However, when the baseline cost is dialed back such that $A/P=98/56$, the path jumps discontinuously through the origin ($\yhat=0$). Intermediate paths are not cost-effective: at a certain point, what we save by avoiding the dead center is not worth the extra steps.

\begin{figure}
\includegraphics[width=\columnwidth]{graphix/Gaussian.png}
\caption{Gaussian Cost Function - Straight path is optimal when $P=56$, the bracket path when $P=55$. }
\label{fig:gaussian}
\end{figure}

\subsection{Theory}
Our goal is to show why there are certain parameters that result in one of the three behaviors discussed. 
\begin{enumerate}
\item Minimum path cost is at $\yhat=0$
\item Minimum path cost is at finite $\yhat>0$
\item Minimum path cost is infinitely far away. 
\end{enumerate}

The cost of a bracket path in terms of the model parameters and some choice of $\yhat$ is 
\begin{align*}
C(p_{\yhat}) =& C(\text{segment 1}) + C(\text{segment 2}) + C(\text{segment 3}) \\
=&\Big[\yhat P + \sum\limits_{i=0}^{\yhat-1} f(-n, i) \Big] +
         \Big[2nP + \sum\limits_{x=-n}^{n}    f(x,\yhat) \Big]\\
     &+\Big[\yhat P + \sum\limits_{i=0}^{\yhat-1} f(n, i) \Big].
\end{align*}

Now let us assume that we begin far from the obstacle, so $n \gg \sigma$; in this limit, the cost due to the obstacle on segments 1 and 3 is very small compared to the baseline cost and the cost along segment 2.
\begin{equation}
C(p_{\yhat}) \approx (2n+2\yhat)P +  \sum\limits_{x=-n}^{n} f(x,\yhat)
\end{equation}

We are only concerned with the cost of each path in relation to other paths, so we will express the cost of some $p_{\yhat}$ relative to the cost of the direct path like so. 
\begin{align*}
\Delta C(\yhat) =& C(\yhat)-C(0) \\
=& \Big[(2n+2\yhat)P +  \sum\limits_{x=-n}^{n} f(x,\yhat) \Big] \\
 & - \Big[(2n+2(0))P +  \sum\limits_{x=-n}^{n} f(x,0) \Big] \\
=& 2P\yhat + \sum\limits_{x=-n}^{n} \Big[ f(x,\yhat)-f(x,0) \Big]
\end{align*}

When $\Delta C < 0$ for some $\yhat$, the direct path is not optimal.

With a Gaussian obstacle as $f$,
\begin{equation}
\Delta C(\yhat) = 2P\yhat + \sum\limits_{x=-n}^{n} \left[A\exp\left(-\frac{x^2 + \yhat^2}{2\sigma^2}\right) - A\exp\left(-\frac{x^2}{2\sigma^2}\right) \right]
\end{equation}

We have already assumed $n \gg \sigma$, so we can approximate the sum over $x \in [-n, n]$ as the sum over all $x$, which has a simple solution. The tails of the Gaussian contribute negligibly.

\begin{equation}
\sum\limits_{x=-n}^{n} \rightarrow \text{Future Dan will sort this out.}
\end{equation}

Finally, we have a closed-form expression for the cost of bracket path $p_{\yhat}$ compared to the direct path.
\begin{equation}
\Delta C(\yhat) = 2P\yhat + A\sigma\sqrt{2\pi}\left[\exp\left(-\frac{\yhat^2}{2\sigma^2}\right) - 1\right]
\end{equation}

Now, we locate the $\yhat$ that minimize $\Delta C$.
\begin{align}
\frac{d\Delta C}{d\yhat} = 
&2P - \frac{\yhat}{\sigma}A\sqrt{2\pi} \exp\left(-\frac{\yhat^2}{2\sigma^2} \right) = 0 \\
  \frac{P}{A} =& \sqrt{\frac{\pi}{2}} \frac{\yhat}{\sigma} \exp\left(-\frac{\yhat^2}{2\sigma^2} \right)
  \label{eq:PA}
\end{align}
\begin{figure}
\centering
\includegraphics[width=0.4\columnwidth]{graphix/lambert.png}
\caption{Plot of $x \exp(-x^2)$, with lines marking values where the equation has no solutions (top line), one solution (middle line) or two solutions (bottom line).}
\label{fig:lambert}
\end{figure}

The solution for $\yhat$ is related to the Lambert W-function, which is cannot be written in closed form.  Depending on the cost ratio $P/A$, it admits 0, 1 or 2 solutions, illustrated in Figure \ref{fig:lambert}. We can make several observations. See Figure \ref{fig:globfig}.
\begin{enumerate}
\item Eq. \ref{eq:PA} peaks when $\yhat/\sigma = 1$, attaining $P/A=\sqrt{\pi/2e}$. If we set $P$ and $A$ such that $P/A > \sqrt{\pi/2e} \approx 0.760$, there is no solution to Eq. \ref{eq:PA}, and the only minimum of $\Delta C$ occurs on the boundary at $\yhat=0$. The direct path is optimal.
\item The inflection point that forms at $P/A = \sqrt{\pi/2e}$ grows into a local minimum as $P/A$ is dialed down. Below $P/A \approx 0.56553$, which was determined numerically, the local minimum becomes the global minimum. The obstacle is avoided.
\item When $P=0$, $\Delta C$ has a minimum at infinity. We require a finite baseline cost to keep the solution from running to $y \rightarrow \infty$ before traversing $x$.
\end{enumerate}

\begin{figure}[t]
\centering

\subfloat[$P/A = \sqrt{\pi/2e}$: The direct path $\yhat=0$ minimizes $\Delta C$. A plateu is forming.]{
\includegraphics[width=0.4\columnwidth]{graphix/Dan_1.png}
\label{fig:Dan_1}}
\qquad
\subfloat[$P/A = 0.56552$: A new global minimum is established at $\yhat > 0$.]{
\includegraphics[width=0.4\columnwidth]{graphix/Dan_3.png}
\label{fig:Dan_3}}\\
\subfloat[$P/A < 0.56552$. $\yhat$ moves farther from the origin, and the minimum grows deeper.]{
\includegraphics[width=0.4\columnwidth]{graphix/Dan_2.png}
\label{fig:Dan_4}}
\qquad
\subfloat[$P=0$, and the global minimum is at $\yhat \rightarrow \infty$.]{
\includegraphics[width=0.4\columnwidth]{graphix/Dan_2.png}
\label{fig:Dan_2}}
\caption{Cost $\Delta C$ relative to the cost of the direct path, as a function of ratio of the baseline cost-per-step $P$ and the amplitude $A$ of a Gaussian obstacle.}
\label{fig:globfig}
\end{figure}

